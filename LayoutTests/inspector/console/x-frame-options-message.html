<!doctype html>
<html>
<head>
<script src="../../http/tests/inspector/resources/inspector-test.js"></script>
<script>
function test()
{
    let suite = InspectorTest.createAsyncSuite("Console.XFrameOptionsMessages");

    suite.addTestCase({
        name: "XFrameOptionsDeny",
        description: "Ensure that a console message is logged when enforcing an X-Frame-Options policy. In this case, setting X-Frame-Options: 'deny' means the iframe does not want to be embedded in the test page.",
        test(resolve) {
            WI.consoleManager.addEventListener(WI.ConsoleManager.Event.MessageAdded, (event) => {
                let { target, messageText, source, level } = event.data.message;
                InspectorTest.log({ targetType: target.type, messageText, source, level });
                resolve();
            });
            InspectorTest.evaluateInPage(`triggerXFrameOptionDeny()`);
        }
    });

    suite.runTestCasesAndFinish();
}
</script>
</head>
<body onload="runTest()">
  <iframe id="denied"></iframe>
  <script>
  function triggerXFrameOptionDeny()
  {
    let deniedFrame = document.getElementById('denied');
    let deniedDocument = deniedFrame.contentWindow.document;
    deniedDocument.write('<meta http-equiv="X-Frame-Options" content="deny"/>');
  }
  </script>
</body>
</html>

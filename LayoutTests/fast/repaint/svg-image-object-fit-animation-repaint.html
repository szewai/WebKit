<!DOCTYPE html>
<html>
<head>
<title>Animated SVG with intrinsic dimensions and object-fit: cover should not leave artifacts</title>
<meta name="fuzzy" content="maxDifference=0-1; totalPixels=0-1" />
<script src="../../resources/ui-helper.js"></script>
<style>
    body {
        margin: 0;
    }
    .container {
        width: 200px;
        height: 200px;
        overflow: hidden;
        background: white;
    }
    .image {
        height: 100%;
        width: 100%;
        object-fit: cover;
    }
</style>
</head>
<body>
<p>You should see a green rectangle on white with no artifacts.</p>
<div class="container">
    <img class="image" src="data:image/svg+xml,
        <svg xmlns='http://www.w3.org/2000/svg' width='500' height='200'>
            <style>
                @keyframes rotate {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(10deg); }
                }
                .animated {
                    transform-origin: 250px 100px;
                    animation: rotate 50ms linear forwards;
                }
            </style>
            <rect class='animated' x='200' y='50' width='100' height='100' fill='green'/>
        </svg>">
</div>
<script>
if (window.testRunner) {
    testRunner.waitUntilDone();
    testRunner.dontForceRepaint();
}

window.addEventListener('load', async () => {
    await UIHelper.renderingUpdate();
    await new Promise(r => setTimeout(r, 60));
    await UIHelper.renderingUpdate();
    await UIHelper.renderingUpdate();
    window.testRunner?.notifyDone();
});
</script>
</body>
</html>
